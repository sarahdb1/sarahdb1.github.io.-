install.packages("tidyverse")
install.packages("stargazer")
install.packages("dyplr")

library(tidyverse)
library(stargazer)
library(ggplot2)
library(dyplr)

# Charger les données
CSES_1 <- read.csv("/Users/sarahdulude-bellavance/Documents/CSES_1.csv")

# Nettoyer les données pour enlever les NA
cses_clean <- CSES_1 %>%
  drop_na(education, gauche_droite)

# Régression linéaire simple
modele <- lm(gauche_droite ~ education, data = cses_clean)

summary(modele)

# Visualisation (nuage de points + ligne de régression)
ggplot(cses_clean, aes(x = education, y = gauche_droite)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = "lm", se = TRUE) +
  labs(
    title = "Relation entre niveau d'éducation et positionnement politique",
    x = "Niveau d'éducation",
    y = "Orientation gauche-droite"
  ) +
  theme_minimal()
